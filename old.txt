Goal

Reliably detect ONLY the first real chess move (e.g. e2â†’e4) from a noisy video stream and write a PGN with exactly one move.

ğŸ§± Core Principles

Vision is noisy â†’ never trusted alone

python-chess is the single authority

Time (multiple frames) confirms truth

Stop after first accepted move

ğŸ“¥ Input (per frame)

From vision:

piece_map = { square â†’ piece }


Example: { "e2": "P", "e7": "p", ... }

No FENs, no snapshots, no history.

ğŸ§  Internal State

previous_piece_map

current_piece_map

candidate_move_counter (per move)

chess.Board() (standard start)

N = 3 (frames required for confirmation)

ğŸ” Single Frame Loop

For every frame:

Log raw detections

Compare with previous frame

find disappeared squares â†’ from

find appeared squares â†’ to

Generate candidate moves

(from_square â†’ to_square)

Validate with python-chess

board.is_legal(move)

Temporal confirmation

same legal move seen in N consecutive frames

Accept first stabilized move

board.push(move)

write PGN with exactly one move

stop tracking

âœ… Acceptance Rule

A move is accepted only if:

legal according to python-chess

detected consistently across N frames

This filters:

noisy detections

hallucinated moves (h3, f3, etc.)

ğŸ“„ Output

PGN file with one move only

1. e4

ğŸ§© Why This Works

Early noise dies out (not stable)

Real move persists across frames

Chess rules gate everything

Matches idChess / ChessCam philosophy

ğŸš€ What This Enables Later

Extend to move 2, 3, â€¦

Re-enable snapshots or FENs later

Improve vision without changing logic