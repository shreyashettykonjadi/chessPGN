âœ… DONE (for context)

Step 0: Video â†’ warped board â†’ piece_map

Step 1: Label sanitization (reject garbage)

Step 1.5: Frame index propagation

Step 4: Candidate generation + legality check

Step 5: Temporal confirmation logic

Youâ€™re now at the â€œhonest but too strictâ€ stage.

ðŸ§­ STEPS LEFT (UNTIL FIRST VALID MOVE)
ðŸŸ¡ STEP 2 â€” Board Sanity Filter

Goal: Allow imperfect frames that still look like chess.

Exactly 1 white king + 1 black king

No side has >16 pieces

Reject otherwise

ðŸ“Œ Result:
Some frames finally pass â†’ deltas start to matter.

ðŸŸ¡ STEP 3 â€” Canonicalize Piece Labels (MINIMAL)

Goal: Translate model labels â†’ chess symbols.

white_rook â†’ R

black_knight â†’ n

etc.

Reject labels that donâ€™t map

ðŸ“Œ Result:
Sanitization stops killing all frames.

ðŸŸ¡ STEP 4 â€” First-Move Gate (Single Commit)

Goal: Lock the first move once.

When a move becomes STABLE:

push to chess.Board

store as first_move

stop accepting new moves

ðŸ“Œ Result:
Exactly one move is committed.

ðŸŸ¡ STEP 5 â€” Early Stop After First Move

Goal: Donâ€™t process useless frames.

Stop video loop once first move is locked

Write PGN with one move only

ðŸ“Œ Result:
Assignment goal satisfied.

ðŸŽ¯ END STATE (what youâ€™ll have)

Video runs

Vision noisy but gated

e2e4 detected and stabilized

output.pgn contains:

1. e4


No hacks

No cheating

Real pipeline